(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,11186,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(6606);e.i(36180);var r=e.i(98925);e.i(51718);var o=e.i(18357);let l=(0,o.getAuth)();function n(){let[e,n]=(0,s.useState)(null),[d,i]=(0,s.useState)([]),[c,u]=(0,s.useState)(!0);(0,s.useEffect)(()=>{let e=(0,o.onAuthStateChanged)(l,e=>n(e));return()=>e()},[]),(0,s.useEffect)(()=>{(async()=>{if(e)try{let t=(0,r.query)((0,r.collection)(a.db,"consultations"),(0,r.where)("doctorId","==",e.uid)),s=(await (0,r.getDocs)(t)).docs.map(e=>({id:e.id,...e.data()}));i(s)}catch(e){console.error("Error loading requests:",e)}finally{u(!1)}})()},[e]);let p=async e=>{let t="approved"===e.status?"pending":"approved";try{await (0,r.updateDoc)((0,r.doc)(a.db,"consultations",e.id),{status:t,..."approved"===t?{approvedAt:(0,r.serverTimestamp)()}:{approvedAt:null}}),i(s=>s.map(s=>s.id===e.id?{...s,status:t}:s))}catch(e){console.error("Failed to toggle approval:",e),alert("Failed to update request status.")}};return e?c?(0,t.jsx)("div",{className:"p-8",children:"Loading your requests..."}):(0,t.jsxs)("div",{className:"w-full p-12",children:[(0,t.jsx)("h1",{className:"text-xl font-bold mb-4",children:"My Consultation Requests"}),0===d.length?(0,t.jsx)("p",{children:"No requests yet."}):d.map(e=>{let s=e.createdAt?.toDate?.()||("string"==typeof e.createdAt?e.createdAt:null),a="approved"===e.status;return(0,t.jsxs)("div",{className:"p-4 border rounded-lg mb-4 bg-gray-50 shadow-sm flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold",children:e.patientName||"Unknown patient"}),(0,t.jsxs)("p",{children:["Email: ",e.patientEmail||"-"]}),(0,t.jsxs)("p",{children:["Phone: ",e.patientPhone||"-"]}),(0,t.jsxs)("p",{children:["Status: ",e.status]}),(0,t.jsxs)("p",{children:["Requested At:"," ",s?new Date(s).toLocaleString():"—"]})]}),("pending"===e.status||"approved"===e.status)&&(0,t.jsx)("button",{onClick:()=>p(e),className:`text-xl font-bold border-2 rounded-2xl p-1 transition hover:scale-110 ${a?"text-green-600  border-green-500  ":"text-gray-400 border-red-500 "}`,title:a?"Click to revert approval":"Approve request",children:"✓"})]},e.id)})]}):(0,t.jsx)("div",{className:"p-8",children:"Please log in as a doctor."})}e.s(["default",()=>n])}]);